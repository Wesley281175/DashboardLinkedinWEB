<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Dashboard ALCANCE + ENGAJAMENTO LinkedIn v.1.2 LITE</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#1a1a1a 0%,#2d2d2d 100%);color:#fff;min-height:100vh}
.container{max-width:1400px;margin:0 auto;padding:20px}
.header{display:flex;align-items:center;justify-content:center;margin-bottom:30px;padding:20px;background:rgba(0,0,0,.3);border-radius:10px;border:1px solid #2c5aa0}
.header-text{text-align:center}
.header h1{color:#fff;font-size:2.2em;margin-bottom:10px;text-shadow:0 2px 4px rgba(0,0,0,.5)}
.header .version{color:#b3b3b3;font-size:1.1em;margin-bottom:10px;font-style:italic}
.header p{color:#fff;font-size:1.3em}
.header .author{color:#b3b3b3;font-size:.9em;font-weight:bold;font-style:italic;margin-top:8px}
.controls{display:flex;flex-wrap:wrap;gap:20px;margin-bottom:30px;align-items:center;justify-content:center}
.file-input-container{position:relative;overflow:hidden;display:inline-block}
.file-input{position:absolute;left:-9999px}
.file-input-label{background:#2c5aa0;color:#fff;padding:12px 24px;border-radius:6px;cursor:pointer;transition:.3s;display:inline-block;font-weight:bold}
.file-input-label:hover{background:#1e3d6f;transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,.3)}
.period-selector{display:flex;gap:10px;flex-wrap:wrap}
.period-btn{padding:10px 20px;background:#333;color:#fff;border:2px solid #555;border-radius:6px;cursor:pointer;transition:.3s;font-weight:bold}
.period-btn:hover{background:#2c5aa0;border-color:#2c5aa0}
.period-btn.active{background:#2c5aa0;border-color:#2c5aa0}
.main-content-inner{display:flex;flex-direction:column;gap:30px}
.metrics-grid-container{display:grid;grid-template-columns:repeat(5,1fr);gap:15px;margin-bottom:20px}
.result-card{background:rgba(255,255,255,.1);padding:15px;border-radius:8px;text-align:center;border:2px solid #555;transition:.3s;min-height:120px;display:flex;flex-direction:column;justify-content:center}
.result-card.good{border-color:#90EE90;background:rgba(144,238,144,.1)}
.result-card.excellent{border-color:#7FFFD4;background:rgba(127,255,212,.1)}
.result-card.poor{border-color:#FF2800;background:rgba(255,40,0,.1)}
.metric-item{background:rgba(255,255,255,.05);padding:15px;border-radius:8px;border-left:4px solid #2c5aa0;font-size:.9em;min-height:140px}
.totals-bar{background:rgba(44,90,160,.2);border:1px solid #2c5aa0;border-radius:6px;padding:15px;text-align:center;color:#fff;font-weight:bold;font-size:1em;margin-bottom:30px;display:flex;justify-content:center;flex-wrap:wrap;gap:10px}
.total-item{padding:5px 10px;background:rgba(0,0,0,.2);border-radius:4px;display:flex;flex-direction:column;align-items:center;min-width:120px}
.total-item .value{font-size:1.2em;color:#FFD700}
.total-item .label{font-size:.8em;color:#b3b3b3}
.metrics-info{background:rgba(0,0,0,.4);border-radius:10px;padding:20px;border:1px solid #555}
.metrics-info h3{color:#fff;margin-bottom:15px;text-align:center}
.metric-name{font-weight:bold;color:#fff;margin-bottom:5px;font-size:.95em}
.metric-formula{font-size:.8em;color:#ccc;margin-bottom:8px}
.range-good{color:#90EE90}
.range-excellent{color:#7FFFD4}
.result-value{font-size:1.4em;font-weight:bold;margin-bottom:5px}
.result-label{font-size:.85em;color:#ccc;margin-bottom:8px}
.status-indicator{padding:4px 8px;border-radius:4px;font-weight:bold;font-size:.75em;display:inline-block;margin:0 auto}
.period-info{background:rgba(44,90,160,.2);border:1px solid #2c5aa0;border-radius:6px;padding:15px;text-align:center;color:#fff;font-weight:bold;font-size:1em;margin-bottom:30px}
.status-good{background:#90EE90;color:#000}
.status-excellent{background:#2E8B57;color:#fff}
.status-poor{background:#FF2800;color:#fff}
.error-message{background:rgba(244,67,54,.1);border:1px solid #f44336;color:#f44336;padding:15px;border-radius:8px;margin:20px 0;text-align:center}
.footer{margin-top:40px;padding:15px;text-align:center;font-size:.75em;color:#888;border-top:1px solid #444;background:rgba(0,0,0,.2)}
.footer p{margin:5px 0;font-style:italic}
.hidden{display:none!important}
#activation-screen{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.95);display:flex;justify-content:center;align-items:center;z-index:10000}
.activation-container{background:#2d2d2d;padding:30px;border-radius:10px;text-align:center;max-width:500px}
.activation-container h2{color:#FFD700;margin-bottom:20px}
.activation-container input{padding:12px;width:100%;margin-bottom:15px;border-radius:5px;border:1px solid #555;background:#1a1a1a;color:#fff}
.activation-container button{padding:12px 24px;background:#2c5aa0;color:#fff;border:none;border-radius:5px;cursor:pointer;font-weight:bold}
.charts-row{display:flex;flex-direction:column;gap:30px;margin:30px 0}
.charts-row canvas{background:#fff;border-radius:8px;padding:10px;max-height:300px;width:100%}
@media(max-width:1024px){
.metrics-grid-container{grid-template-columns:repeat(2,1fr)}
}
@media(max-width:768px){
.metrics-grid-container{grid-template-columns:1fr}
.totals-bar{flex-direction:column;align-items:center}
.total-item{min-width:unset;width:80%}
.charts-row{display:none}
}
</style>
</head>
<body>
<div id="activation-screen">
<div class="activation-container">
<h2>Ativa√ß√£o Requerida</h2>
<p>Digite a chave de licen√ßa para usar o dashboard.</p>
<input type="text" id="license-key" placeholder="Chave de licen√ßa">
<button id="activation-button">Ativar</button>
</div>
</div>
<div id="main-content" class="hidden">
<div class="container">
<div class="header">
<div class="header-text">
<h1>Dashboard ALCANCE + ENGAJAMENTO LinkedIn v.1.2 LITE</h1>
<div class="version">"Vers√£o Web"</div>
<p>An√°lise de M√©tricas de Alcance e Engajamento</p>
<div class="author">by Coach Wesley A C</div>
</div>
</div>
<div class="controls">
<div class="file-input-container">
<input type="file" id="fileInput" class="file-input" accept=".xlsx,.xls">
<label for="fileInput" class="file-input-label">üìÅ Carregar Arquivo Excel</label>
</div>
<div class="period-selector">
<button class="period-btn active" data-period="7">7 Dias</button>
<button class="period-btn" data-period="14">14 Dias</button>
<button class="period-btn" data-period="28">28 Dias</button>
<button class="period-btn" data-period="90">90 Dias</button>
</div>
</div>
<div class="main-content-inner">
<div id="dashboardSection">
<div id="periodInfo" class="period-info">üìä Aguardando carregamento do arquivo Excel...</div>
<div id="totalsBar" class="totals-bar" style="display:none;">
<div class="total-item"><div class="value" id="totalImpressions">0</div><div class="label">Impress√µes</div></div>
<div class="total-item"><div class="value" id="totalReached">0</div><div class="label">Usu√°rios alcan√ßados</div></div>
<div class="total-item"><div class="value" id="totalEngagements">0</div><div class="label">Engajamentos</div></div>
<div class="total-item"><div class="value" id="totalFollowers">0</div><div class="label">Seguidores</div></div>
</div>
<div id="results" class="metrics-grid-container"></div>
</div>
<div class="metrics-info">
<h3>üìä M√©tricas IDEAIS</h3>
<div class="metrics-grid-container" id="idealParams">
<div class="metric-item"><div class="metric-name">1. Taxa Alcance</div><div class="metric-formula">Usu√°rios alcan√ßados √∑ Soma seguidores</div><div class="metric-ranges"><span class="range-good">0,05-0,15 = BOM</span> <span class="range-excellent">&gt;0,15 = √ìTIMO</span></div></div>
<div class="metric-item"><div class="metric-name">2. Taxa Engajamento</div><div class="metric-formula">Soma engajamentos √∑ Impress√µes</div><div class="metric-ranges"><span class="range-good">0,5-2 = BOM</span> <span class="range-excellent">&gt;2 = √ìTIMO</span></div></div>
<div class="metric-item"><div class="metric-name">3. Engajamentos/Usu√°rios alcan√ßados</div><div class="metric-formula">Soma engajamentos √∑ Usu√°rios alcan√ßados</div><div class="metric-ranges"><span class="range-good">1-3 = BOM</span> <span class="range-excellent">&gt;3 = √ìTIMO</span></div></div>
<div class="metric-item"><div class="metric-name">4. Taxa Engajamento/Impress√µes</div><div class="metric-formula">Taxa engajamento √∑ Impress√µes</div><div class="metric-ranges"><span class="range-good">1-3 marca nova = BOM</span> <span class="range-excellent">4-9 convers√£o = √ìTIMO</span></div></div>
<div class="metric-item"><div class="metric-name">5. Frequ√™ncia Exibi√ß√£o</div><div class="metric-formula">Soma impress√µes √∑ Soma usu√°rios alcan√ßados</div><div class="metric-ranges"><span class="range-good">1-3 marca nova = BOM</span> <span class="range-excellent">4-9 convers√£o = √ìTIMO</span></div></div>
</div>
</div>
</div>
<div id="errorMessage"></div>
<div class="charts-row">
<canvas id="chartEngagements"></canvas>
<div class="period-selector" style="justify-content:center;margin-top:10px;">
<button class="period-btn" data-period="7">7 Dias</button>
<button class="period-btn" data-period="14">14 Dias</button>
<button class="period-btn" data-period="28">28 Dias</button>
<button class="period-btn" data-period="90">90 Dias</button>
</div>
<canvas id="chartImpressions"></canvas>
<canvas id="chartFollowers"></canvas>
</div>
<div class="footer">
<p>"Total de usu√°rios alcan√ßados n√£o alteram pois os dados s√£o fixos por per√≠odo, n√£o por varia√ß√£o di√°ria."</p>
<p>"O dashboard exibe uma precis√£o de 98,1%, com uma margem de erro m√≠nima de 1,9%."</p>
<p>"Carregue relat√≥rios de 90 dias, para uma an√°lise mais assertiva em todas varia√ß√µes de per√≠odos dispon√≠veis no dashboard."</p>
</div>
</div>
</div>
<script>
!function(){const a="DASH-BOAR-DALC-1975",b=document.getElementById("main-content"),c=document.getElementById("activation-screen");let d=7,e=[],f=[],g=[],h,i,j;function k(){c.style.display="flex",l()}function l(){document.getElementById("activation-button").addEventListener("click",function(){const d=document.getElementById("license-key").value;d===a?(localStorage.setItem("licencaDashboard",d),c.style.display="none",b.classList.remove("hidden"),m()):alert("Chave de licen√ßa inv\u00e1lida.")})}function m(){document.getElementById("fileInput").addEventListener("change",n),document.querySelectorAll(".period-btn").forEach(a=>{a.addEventListener("click",function(c){document.querySelectorAll(".period-btn").forEach(a=>a.classList.remove("active")),c.target.classList.add("active"),d=parseInt(c.target.getAttribute("data-period"),10),e.length&&p(d)})})}function n(a){const b=a.target.files[0];if(!b)return;if(!b.name.endsWith(".xlsx")&&!b.name.endsWith(".xls"))return C("Por favor, selecione um arquivo Excel v\u00e1lido (.xlsx ou .xls).");const c=new FileReader;c.onload=function(a){try{const c=new Uint8Array(a.target.result),d=XLSX.read(c,{type:"array"});o(d),p(d),D()}catch(a){C("Erro ao processar arquivo Excel: "+a.message)}};c.readAsArrayBuffer(b)}function o(a){const b=a.Sheets.Descoberta;if(!b)throw new Error('Planilha "Descoberta" n\u00e3o encontrada.');g=XLSX.utils.sheet_to_json(b,{header:1,raw:!0});const c=a.Sheets.Engajamento;if(!c)throw new Error('Planilha "Engajamento" n\u00e3o encontrada.');e=XLSX.utils.sheet_to_json(c,{header:1,raw:!0});const d=a.Sheets.Seguidores;if(!d)throw new Error('Planilha "Seguidores" n\u00e3o encontrada.');f=XLSX.utils.sheet_to_json(d,{header:1,raw:!0})}function p(a){D();let b=0;g.length>=3&&g[2]?.length>=2&&(b=parseFloat(String(g[2][1]).toString().replace(/\./g,"").replace(",",".")))||0;const c=q(e,a);let d=0,k=0;if(c.length>1){const a=c[0],e=u(a,"impress"),f=u(a,"engaj");if(e===-1||f===-1)return C('Aba "Engajamento": verifique as colunas "Impress\u00f5es" e "Engajamento".');for(let a=1;a<c.length;a++){const b=c[a]||[];d+=v(b[e]),k+=v(b[f])}}const l=r(f,a);let m=0;if(l.length>3){const a=l[2],b=u(a,"novos seg");if(b===-1)return C('Aba "Seguidores": verifique a coluna "Novos seguidores".');for(let a=3;a<l.length;a++){const c=l[a]||[];m+=v(c[b])}}B("totalImpressions",d),B("totalReached",b),B("totalEngagements",k),B("totalFollowers",m),document.getElementById("totalsBar").style.display="flex",document.getElementById("periodInfo").innerText=`üìä An\u00e1lise dos \u00faltimos ${a} dias`;const n={reachRate:{name:"Taxa Alcance",value:m>0?b/m:0},engagementRate:{name:"Taxa Engajamento",value:d>0?k/d:0},engagementsPerReach:{name:"Engajamentos/Usu\u00e1rios alcan\u00e7ados",value:b>0?k/b:0},engagementPerImpressions:{name:"Taxa Engajamento/Impress\u00f5es",value:d>0?k/d:0},displayFrequency:{name:"Frequ\u00eancia Exibi\u00e7\u00e3o",value:b>0?d/b:0}};A(n),s(c,l)}function q(a,b){if(a.length<=1)return a;const c=a[0],d=u(c,"data");if(d===-1)return a;const e=w(a.slice(1),d);if(!e)return a;const f=new Date(e);f.setHours(0,0,0,0),f.setDate(f.getDate()-(b-1));const g=[c];for(let b=1;b<a.length;b++){const c=x(a[b][d]);c&&c>=f&&c<=e&&g.push(a[b])}return g}function r(a,b){if(a.length<=3)return a;const c=a[2],d=u(c,"data");if(d===-1)return a;const e=w(a.slice(3),d);if(!e)return a;const f=new Date(e);f.setHours(0,0,0,0),f.setDate(f.getDate()-(b-1));const g=a.slice(0,3);for(let b=3;b<a.length;b++){const c=x(a[b][d]);c&&c>=f&&c<=e&&g.push(a[b])}return g}function s(a,b){const c=a[0],d=u(c,"data"),e=u(c,"impress"),f=u(c,"engaj"),g=[],k=[],l=[];for(let b=1;b<a.length;b++){const c=a[b];g.push(c[d]),k.push(v(c[e])),l.push(v(c[f]))}const m=b[2],n=u(m,"data"),o=u(m,"novos seg"),p=[],q=[];for(let a=3;a<b.length;a++){const c=b[a];p.push(c[n]),q.push(v(c[o]))}h&&h.destroy(),i&&i.destroy(),j&&j.destroy();const r={ticks:{color:"#444",font:{size:12,weight:"500"}},title:{display:!0,text:"Total",color:"#444",font:{size:12,weight:"700"},padding:{top:6,bottom:6}},grid:{color:"rgba(0,0,0,0.06)"}};i=new Chart(document.getElementById("chartEngagements"),{type:"line",data:{labels:g,datasets:[{label:"Engajamentos",data:l,borderColor:"red",backgroundColor:"rgba(255,0,0,0.15)",fill:!0,tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:r,x:{ticks:{color:"#444",font:{size:11}}}},plugins:{legend:{display:!1}}}}),h=new Chart(document.getElementById("chartImpressions"),{type:"line",data:{labels:g,datasets:[{label:"Impress√µes",data:k,borderColor:"blue",backgroundColor:"rgba(0,0,255,0.15)",fill:!0,tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:r,x:{ticks:{color:"#444",font:{size:11}}}},plugins:{legend:{display:!1}}}}),j=new Chart(document.getElementById("chartFollowers"),{type:"line",data:{labels:p,datasets:[{label:"Seguidores",data:q,borderColor:"green",backgroundColor:"rgba(0,128,0,0.15)",fill:!0,tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:r,x:{ticks:{color:"#444",font:{size:11}}}},plugins:{legend:{display:!1}}}}),document.getElementById("chartEngagements").style.height="320px",document.getElementById("chartImpressions").style.height="320px",document.getElementById("chartFollowers").style.height="320px"}function t(a){const b=Math.floor(a-25569),c=86400*b,d=new Date(1e3*c);return new Date(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate())}function u(a,b){if(!Array.isArray(a))return-1;let c=-1;return a.forEach((a,d)=>{const e=String(a||"").toLowerCase();e.includes(b.toLowerCase())&&(c=-1===c?d:c)}),c}function v(a){if(null==a)return 0;if("number"==typeof a)return a;const b=String(a).trim().replace(/\./g,"").replace(",",".");return a=parseFloat(b),isNaN(a)?0:a}function w(a,b){let c=null;return a.forEach(a=>{const d=x(a?.[b]);d&&(!c||d>c)&&(c=d)}),c}function x(a){if(null!=a&&0!==a){if(a instanceof Date&&!isNaN(a))return new Date(a.getFullYear(),a.getMonth(),a.getDate());if("number"==typeof a)return t(a);if("string"==typeof a){const b=a.trim(),c=/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2,4})$/.exec(b);if(c){const a=parseInt(c[1],10),b=parseInt(c[2],10)-1,d=parseInt(c[3],10),e=d<100?2e3+d:d,f=new Date(e,b,a);if(!isNaN(f))return new Date(f.getFullYear(),f.getMonth(),f.getDate())}}return null}}function A(a){const b=document.getElementById("results");b.innerHTML="",Object.keys(a).forEach(c=>{const d=a[c],e=isFinite(d.value)?d.value:0,f=y(c,e),g=document.createElement("div");g.className=`result-card ${f}`,g.innerHTML=`\n            <div class="result-value">${e.toFixed(2)}</div>\n            <div class="result-label">${d.name}</div>\n            <div class="status-indicator status-${f}">${z(f)}</div>\n          `,b.appendChild(g)})}function y(a,b){if(isNaN(b))return"poor";switch(a){case"reachRate":return b>.15?"excellent":b>=.05?"good":"poor";case"engagementRate":return b>.02?"excellent":b>=.005?"good":"poor";case"engagementsPerReach":return b>3?"excellent":b>=1?"good":"poor";case"engagementPerImpressions":return b>.02?"excellent":b>=.005?"good":"poor";case"displayFrequency":return b>=4?"excellent":b>=1?"good":"poor";default:"poor"}}function z(a){return"excellent"===a?"\xd3TIMO":"good"===a?"BOM":"REVISAR"}function B(a,b){document.getElementById(a).innerText=Number(b).toLocaleString("pt-BR")}function C(a){const b=document.getElementById("errorMessage");b.className="error-message",b.innerText=a,b.style.display="block"}function D(){const a=document.getElementById("errorMessage");a.style.display="none",a.innerText=""}document.addEventListener("DOMContentLoaded",function(){k()})}();
</script>
</body>
</html>
