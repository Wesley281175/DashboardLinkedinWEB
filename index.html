<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Dashboard ALCANCE + ENGAJAMENTO LinkedIn v.1.2 LITE</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#1a1a1a 0%,#2d2d2d 100% );color:#fff;min-height:100vh}
.container{max-width:1400px;margin:0 auto;padding:20px}
.header{display:flex;align-items:center;justify-content:center;margin-bottom:30px;padding:20px;background:rgba(0,0,0,.3);border-radius:10px;border:1px solid #2c5aa0}
.header-text{text-align:center}
.header h1{color:#fff;font-size:2.2em;margin-bottom:10px;text-shadow:0 2px 4px rgba(0,0,0,.5)}
.header .version{color:#b3b3b3;font-size:1.1em;margin-bottom:10px;font-style:italic}
.header p{color:#fff;font-size:1.3em}
.header .author{color:#b3b3b3;font-size:.9em;font-weight:bold;font-style:italic;margin-top:8px}
.controls{display:flex;flex-wrap:wrap;gap:20px;margin-bottom:30px;align-items:center;justify-content:center}
.file-input-container{position:relative;overflow:hidden;display:inline-block}
.file-input{position:absolute;left:-9999px}
.file-input-label{background:#2c5aa0;color:#fff;padding:12px 24px;border-radius:6px;cursor:pointer;transition:.3s;display:inline-block;font-weight:bold}
.file-input-label:hover{background:#1e3d6f;transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,.3)}
.period-selector{display:flex;gap:10px;flex-wrap:wrap}
.period-btn{padding:10px 20px;background:#333;color:#fff;border:2px solid #555;border-radius:6px;cursor:pointer;transition:.3s;font-weight:bold}
.period-btn:hover{background:#2c5aa0;border-color:#2c5aa0}
.period-btn.active{background:#2c5aa0;border-color:#2c5aa0}
.main-content-inner{display:flex;flex-direction:column;gap:30px}
.metrics-grid-container{display:grid;grid-template-columns:repeat(5,1fr);gap:15px;margin-bottom:20px}
.result-card{background:rgba(255,255,255,.1);padding:15px;border-radius:8px;text-align:center;border:2px solid #555;transition:.3s;min-height:120px;display:flex;flex-direction:column;justify-content:center}
.result-card.good{border-color:#90EE90;background:rgba(144,238,144,.1)}
.result-card.excellent{border-color:#7FFFD4;background:rgba(127,255,212,.1)}
.result-card.poor{border-color:#FF2800;background:rgba(255,40,0,.1)}
.metric-item{background:rgba(255,255,255,.05);padding:15px;border-radius:8px;border-left:4px solid #2c5aa0;font-size:.9em;min-height:140px}
.totals-bar{background:rgba(44,90,160,.2);border:1px solid #2c5aa0;border-radius:6px;padding:15px;text-align:center;color:#fff;font-weight:bold;font-size:1em;margin-bottom:30px;display:flex;justify-content:center;flex-wrap:wrap;gap:10px}
.total-item{padding:5px 10px;background:rgba(0,0,0,.2);border-radius:4px;display:flex;flex-direction:column;align-items:center;min-width:120px}
.total-item .value{font-size:1.2em;color:#FFD700}
.total-item .label{font-size:.8em;color:#b3b3b3}
.metrics-info{background:rgba(0,0,0,.4);border-radius:10px;padding:20px;border:1px solid #555}
.metrics-info h3{color:#fff;margin-bottom:15px;text-align:center}
.metric-name{font-weight:bold;color:#fff;margin-bottom:5px;font-size:.95em}
.metric-formula{font-size:.8em;color:#ccc;margin-bottom:8px}
.range-good{color:#90EE90}
.range-excellent{color:#7FFFD4}
.result-value{font-size:1.4em;font-weight:bold;margin-bottom:5px}
.result-label{font-size:.85em;color:#ccc;margin-bottom:8px}
.status-indicator{padding:4px 8px;border-radius:4px;font-weight:bold;font-size:.75em;display:inline-block;margin:0 auto}
.period-info{background:rgba(44,90,160,.2);border:1px solid #2c5aa0;border-radius:6px;padding:15px;text-align:center;color:#fff;font-weight:bold;font-size:1em;margin-bottom:30px}
.status-good{background:#90EE90;color:#000}
.status-excellent{background:#2E8B57;color:#fff}
.status-poor{background:#FF2800;color:#fff}
.error-message{background:rgba(244,67,54,.1);border:1px solid #f44336;color:#f44336;padding:15px;border-radius:8px;margin:20px 0;text-align:center}
.footer{margin-top:40px;padding:15px;text-align:center;font-size:.75em;color:#888;border-top:1px solid #444;background:rgba(0,0,0,.2)}
.footer p{margin:5px 0;font-style:italic}
.hidden{display:none!important}
#activation-screen{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.95);display:flex;justify-content:center;align-items:center;z-index:10000}
.activation-container{background:#2d2d2d;padding:30px;border-radius:10px;text-align:center;max-width:500px}
.activation-container h2{color:#FFD700;margin-bottom:20px}
.activation-container input{padding:12px;width:100%;margin-bottom:15px;border-radius:5px;border:1px solid #555;background:#1a1a1a;color:#fff}
.activation-container button{padding:12px 24px;background:#2c5aa0;color:#fff;border:none;border-radius:5px;cursor:pointer;font-weight:bold}
.charts-row{display:flex;flex-direction:column;gap:30px;margin:30px 0}
.charts-row canvas{background:#fff;border-radius:8px;padding:10px;max-height:300px;width:100%}
@media(max-width:1024px){
.metrics-grid-container{grid-template-columns:repeat(2,1fr)}
}
@media(max-width:768px){
.metrics-grid-container{grid-template-columns:1fr}
.totals-bar{flex-direction:column;align-items:center}
.total-item{min-width:unset;width:80%}
.charts-row{display:none}
}
</style>
</head>
<body>
<div id="activation-screen">
<div class="activation-container">
<h2>Ativa√ß√£o Requerida</h2>
<p>Digite a chave de licen√ßa para usar o dashboard.</p>
<input type="text" id="license-key" placeholder="Chave de licen√ßa">
<button id="activation-button">Ativar</button>
</div>
</div>
<div id="main-content" class="hidden">
<div class="container">
<div class="header">
<div class="header-text">
<h1>Dashboard ALCANCE + ENGAJAMENTO LinkedIn v.1.2 LITE</h1>
<div class="version">"Vers√£o Web"</div>
<p>An√°lise de M√©tricas de Alcance e Engajamento</p>
<div class="author">by Coach Wesley A C</div>
</div>
</div>
<div class="controls">
<div class="file-input-container">
<input type="file" id="fileInput" class="file-input" accept=".xlsx,.xls">
<label for="fileInput" class="file-input-label">üìÅ Carregar Arquivo Excel</label>
</div>
<div class="period-selector">
<button class="period-btn active" data-period="7">7 Dias</button>
<button class="period-btn" data-period="14">14 Dias</button>
<button class="period-btn" data-period="28">28 Dias</button>
<button class="period-btn" data-period="90">90 Dias</button>
</div>
</div>
<div class="main-content-inner">
<div id="dashboardSection">
<div id="periodInfo" class="period-info">üìä Aguardando carregamento do arquivo Excel...</div>
<div id="totalsBar" class="totals-bar" style="display:none;">
<div class="total-item"><div class="value" id="totalImpressions">0</div><div class="label">Impress√µes</div></div>
<div class="total-item"><div class="value" id="totalReached">0</div><div class="label">Usu√°rios alcan√ßados</div></div>
<div class="total-item"><div class="value" id="totalEngagements">0</div><div class="label">Engajamentos</div></div>
<div class="total-item"><div class="value" id="totalFollowers">0</div><div class="label">Seguidores</div></div>
</div>
<div id="results" class="metrics-grid-container"></div>
</div>
<div class="metrics-info">
<h3>üìä M√©tricas IDEAIS</h3>
<div class="metrics-grid-container" id="idealParams">
<div class="metric-item"><div class="metric-name">1. Taxa Alcance</div><div class="metric-formula">Usu√°rios alcan√ßados √∑ Soma seguidores</div><div class="metric-ranges"><span class="range-good">0,05-0,15 = BOM</span> <span class="range-excellent">&gt;0,15 = √ìTIMO</span></div></div>
<div class="metric-item"><div class="metric-name">2. Taxa Engajamento</div><div class="metric-formula">Soma engajamentos √∑ Impress√µes</div><div class="metric-ranges"><span class="range-good">0,5-2 = BOM</span> <span class="range-excellent">&gt;2 = √ìTIMO</span></div></div>
<div class="metric-item"><div class="metric-name">3. Engajamentos/Usu√°rios alcan√ßados</div><div class="metric-formula">Soma engajamentos √∑ Usu√°rios alcan√ßados</div><div class="metric-ranges"><span class="range-good">1-3 = BOM</span> <span class="range-excellent">&gt;3 = √ìTIMO</span></div></div>
<div class="metric-item"><div class="metric-name">4. Taxa Engajamento/Impress√µes</div><div class="metric-formula">Taxa engajamento √∑ Impress√µes</div><div class="metric-ranges"><span class="range-good">1-3 marca nova = BOM</span> <span class="range-excellent">4-9 convers√£o = √ìTIMO</span></div></div>
<div class="metric-item"><div class="metric-name">5. Frequ√™ncia Exibi√ß√£o</div><div class="metric-formula">Soma impress√µes √∑ Soma usu√°rios alcan√ßados</div><div class="metric-ranges"><span class="range-good">1-3 marca nova = BOM</span> <span class="range-excellent">4-9 convers√£o = √ìTIMO</span></div></div>
</div>
</div>
</div>
<div id="errorMessage"></div>
<div class="charts-row">
<canvas id="chartEngagements"></canvas>
<div class="period-selector" style="justify-content:center;margin-top:10px;">
<button class="period-btn" data-period="7">7 Dias</button>
<button class="period-btn" data-period="14">14 Dias</button>
<button class="period-btn" data-period="28">28 Dias</button>
<button class="period-btn" data-period="90">90 Dias</button>
</div>
<canvas id="chartImpressions"></canvas>
<canvas id="chartFollowers"></canvas>
</div>
<div class="footer">
<p>"Total de usu√°rios alcan√ßados n√£o alteram pois os dados s√£o fixos por per√≠odo, n√£o por varia√ß√£o di√°ria."</p>
<p>"O dashboard exibe uma precis√£o de 98,1%, com uma margem de erro m√≠nima de 1,9%."</p>
<p>"Carregue relat√≥rios de 90 dias, para uma an√°lise mais assertiva em todas varia√ß√µes de per√≠odos dispon√≠veis no dashboard."</p>
</div>
</div>
</div>
<script>
!function(){"use strict";const e="DASH-BOAR-DALC-1975",t=document.getElementById("main-content"),n=document.getElementById("activation-screen");let a=7,c=[],o=[],l=[],d,r,s;function i(){n.style.display="flex",u()}function u(){document.getElementById("activation-button").addEventListener("click",()=>{const a=document.getElementById("license-key").value;a===e?(localStorage.setItem("licencaDashboard",a),n.style.display="none",t.classList.remove("hidden"),m()):alert("Chave de licen√ßa inv√°lida.")})}function m(){document.getElementById("fileInput").addEventListener("change",p),document.querySelectorAll(".period-btn").forEach(e=>{e.addEventListener("click",t=>{document.querySelectorAll(".period-btn").forEach(e=>e.classList.remove("active")),t.target.classList.add("active"),a=parseInt(t.target.getAttribute("data-period"),10),c.length&&g(a)})})}function p(e){const t=e.target.files[0];if(t){if(!t.name.endsWith(".xlsx")&&!t.name.endsWith(".xls"))return C("Por favor, selecione um arquivo Excel v√°lido (.xlsx ou .xls).");const n=new FileReader;n.onload=e=>{try{const t=new Uint8Array(e.target.result),n=XLSX.read(t,{type:"array"});f(n),g(a),D()}catch(e){C("Erro ao processar arquivo Excel: "+e.message)}},n.readAsArrayBuffer(t)}}function f(e){const t=e.Sheets.Descoberta;if(!t)throw new Error('Planilha "Descoberta" n√£o encontrada.');l=XLSX.utils.sheet_to_json(t,{header:1,raw:!0});const n=e.Sheets.Engajamento;if(!n)throw new Error('Planilha "Engajamento" n√£o encontrada.');c=XLSX.utils.sheet_to_json(n,{header:1,raw:!0});const a=e.Sheets.Seguidores;if(!a)throw new Error('Planilha "Seguidores" n√£o encontrada.');o=XLSX.utils.sheet_to_json(a,{header:1,raw:!0})}function g(e){D();let t=0;l.length>=3&&l[2]?.length>=2&&(t=parseFloat(String(l[2][1]).toString().replace(/\./g,"").replace(",",".")))||0;const n=h(c,e);let a=0,d=0;if(n.length>1){const e=n[0],c=y(e,"impress"),o=y(e,"engaj");if(-1===c||-1===o)return C('Aba "Engajamento": verifique as colunas "Impress√µes" e "Engajamento".');for(let e=1;e<n.length;e++){const t=n[e]||[];a+=b(t[c]),d+=b(t[o])}}const r=k(o,e);let s=0;if(r.length>3){const e=r[2],t=y(e,"novos seg");if(-1===t)return C('Aba "Seguidores": verifique a coluna "Novos seguidores".');for(let e=3;e<r.length;e++){const n=r[e]||[];s+=b(n[t])}}B("totalImpressions",a),B("totalReached",t),B("totalEngagements",d),B("totalFollowers",s),document.getElementById("totalsBar").style.display="flex",document.getElementById("periodInfo").innerText=`üìä An√°lise dos √∫ltimos ${e} dias`;const i={reachRate:{name:"1. Taxa Alcance",value:s>0?t/s:0},engagementRate:{name:"2. Taxa Engajamento",value:a>0?d/a:0},engagementsPerReach:{name:"3. Engajamentos/Usu√°rios alcan√ßados",value:t>0?d/t:0},engagementPerImpressions:{name:"4. Taxa Engajamento/Impress√µes",value:a>0?d/a:0},displayFrequency:{name:"5. Frequ√™ncia Exibi√ß√£o",value:t>0?a/t:0}};A(i),v(n,r)}function h(e,t){if(e.length<=1)return e;const n=e[0],a=y(n,"data");if(-1===a)return e;const c=x(e.slice(1),a);if(!c)return e;const o=new Date(c);o.setHours(0,0,0,0),o.setDate(o.getDate()-(t-1));const l=[n];for(let t=1;t<e.length;t++){const n=E(e[t][a]);n&&n>=o&&n<=c&&l.push(e[t])}return l}function k(e,t){if(e.length<=3)return e;const n=e[2],a=y(n,"data");if(-1===a)return e;const c=x(e.slice(3),a);if(!c)return e;const o=new Date(c);o.setHours(0,0,0,0),o.setDate(o.getDate()-(t-1));const l=e.slice(0,3);for(let t=3;t<e.length;t++){const n=E(e[t][a]);n&&n>=o&&n<=c&&l.push(e[t])}return l}function v(e,t){const n=e[0],a=y(n,"data"),c=y(n,"impress"),o=y(n,"engaj"),l=[],i=[],u=[];for(let t=1;t<e.length;t++){const n=e[t];l.push(n[a]),i.push(b(n[c])),u.push(b(n[o]))}const m=t[2],p=y(m,"data"),f=y(m,"novos seg"),g=[],h=[];for(let e=3;e<t.length;e++){const n=t[e];g.push(n[p]),h.push(b(n[f]))}d&&d.destroy(),r&&r.destroy(),s&&s.destroy();const k={ticks:{color:"#444",font:{size:12,weight:"500"}},title:{display:!0,text:"Total",color:"#444",font:{size:12,weight:"700"},padding:{top:6,bottom:6}},grid:{color:"rgba(0,0,0,0.06)"}};r=new Chart(document.getElementById("chartEngagements"),{type:"line",data:{labels:l,datasets:[{label:"Engajamentos",data:u,borderColor:"red",backgroundColor:"rgba(255,0,0,0.15)",fill:!0,tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:k,x:{ticks:{color:"#444",font:{size:11}}}},plugins:{legend:{display:!1},title:{display:!0,text:"2. Engajamentos",font:{size:16,weight:"bold"},color:"#333"}}}}),d=new Chart(document.getElementById("chartImpressions"),{type:"line",data:{labels:l,datasets:[{label:"Impress√µes",data:i,borderColor:"blue",backgroundColor:"rgba(0,0,255,0.15)",fill:!0,tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:k,x:{ticks:{color:"#444",font:{size:11}}}},plugins:{legend:{display:!1},title:{display:!0,text:"5. Impress√µes",font:{size:16,weight:"bold"},color:"#333"}}}}),s=new Chart(document.getElementById("chartFollowers"),{type:"line",data:{labels:g,datasets:[{label:"Seguidores",data:h,borderColor:"green",backgroundColor:"rgba(0,128,0,0.15)",fill:!0,tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:k,x:{ticks:{color:"#444",font:{size:11}}}},plugins:{legend:{display:!1},title:{display:!0,text:"1. Seguidores",font:{size:16,weight:"bold"},color:"#333"}}}})
,document.getElementById("chartEngagements").style.height="320px",document.getElementById("chartImpressions").style.height="320px",document.getElementById("chartFollowers").style.height="320px"}function w(e){const t=Math.floor(e-25569),n=86400*t,a=new Date(1e3*n);return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate())}function y(e,t){if(!Array.isArray(e))return-1;let n=-1;return e.forEach((e,a)=>{const c=String(e||"").toLowerCase();c.includes(t.toLowerCase())&&-1===n&&(n=a)}),n}function b(e){if(null==e)return 0;if("number"==typeof e)return e;const t=String(e).trim().replace(/\./g,"").replace(",",".");return e=parseFloat(t),isNaN(e)?0:e}function x(e,t){let n=null;return e.forEach(e=>{const a=E(e?.[t]);a&&(!n||a>n)&&(n=a)}),n}function E(e){if(null!=e&&0!==e){if(e instanceof Date&&!isNaN(e))return new Date(e.getFullYear(),e.getMonth(),e.getDate());if("number"==typeof e)return w(e);if("string"==typeof e){const t=e.trim(),n=/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2,4})$/.exec(t);if(n){const e=parseInt(n[1],10),t=parseInt(n[2],10)-1,a=parseInt(n[3],10),c=a<100?2e3+a:a,o=new Date(c,t,e);if(!isNaN(o))return new Date(o.getFullYear(),o.getMonth(),o.getDate())}}}return null}function A(e){const t=document.getElementById("results");t.innerHTML="",Object.keys(e).forEach(n=>{const a=e[n],c=isFinite(a.value)?a.value:0,o=I(n,c),l=document.createElement("div");l.className=`result-card ${o}`,l.innerHTML=`\n            <div class="result-value">${c.toFixed(2)}</div>\n            <div class="result-label">${a.name}</div>\n            <div class="status-indicator status-${o}">${S(o)}</div>\n          `,t.appendChild(l)})}function I(e,t){if(isNaN(t))return"poor";switch(e){case"reachRate":return t>.15?"excellent":t>=.05?"good":"poor";case"engagementRate":return t>.02?"excellent":t>=.005?"good":"poor";case"engagementsPerReach":return t>3?"excellent":t>=1?"good":"poor";case"engagementPerImpressions":return t>.02?"excellent":t>=.005?"good":"poor";case"displayFrequency":return t>=4?"excellent":t>=1?"good":"poor";default:"poor"}}function S(e){return"excellent"===e?"√ìTIMO":"good"===e?"BOM":"REVISAR"}function B(e,t){document.getElementById(e).innerText=Number(t).toLocaleString("pt-BR")}function C(e){const t=document.getElementById("errorMessage");t.className="error-message",t.innerText=e,t.style.display="block"}function D(){const e=document.getElementById("errorMessage");e.style.display="none",e.innerText=""}document.addEventListener("DOMContentLoaded",()=>{i()})}();
</script>
</body>
</html>
